# Комбинаторика

## Факториалы и перестановки

### Факториал

$n!$ – **факториал** натурального $\Bbb N$ числа $n$ это произведение всех натуральных чисел от $1$ до $n$.
$n! = n ⋅ (n−1) ⋅ (n−2) ⋅ ... ⋅ 3 ⋅ 2 ⋅ 1$

$n! = n ⋅ (n−1)!$ 
$0! = 1$

### Перестановки

**Правило суммы** – если объект $A$ можно выбрать $n$ способами, а объект $B$ можно выбрать $m$ способами, то объект «$A$ или $B$» можно выбрать $n + m$ способами.

**Правило произведения** – если объект $A$ можно выбрать $n$ способами и после каждого такого выбора объект $B$ можно выбрать $m$ способами, то для пары «$A$ и $B$» есть $n⋅m$ вариантов выбора.

$P_n$ – **перестановка $n$ объектов** или перестановка длины $n$ – это способ их последовательного расположения относительно порядка, например: $abc$, $bca$ и $cab$ – это разные перестановки из трёх букв.
$P_n = n!$

**Беспорядок** (*derangement*) **длины $n$** – любая перестановка множества $\{ 1, 2, ..., n \}$, у которой каждый элемент стоит не на своём месте.

Число всех беспорядков длины $n$ обозначают через $!n$. Читается как «**субфакториал**».
$!n = (n - 1) \cdot (!(n - 1) + !(n - 2))$
$!0 = 1$

### Размещения

#### Слова и кортежи

**Алфавит** – заданное множество символов.

**Слово** – упорядоченный набор символов заданного алфавита. Символы в слове могут повторяться, а разный порядок символов соответствует разным словам.

Количество возможных слов длиной $k$ над алфавитом из $n$ равно $n^k$.

**Кортеж** длины $k$ из элементов множества $A$ – упорядоченный набор $(a_1, a_2, ..., a_k)$, каждый элемент которого принадлежит множеству $A$.

Кортеж длины $k$ называют «$k$-кортеж». Если множество $A$ состоит из $n$ элементов, то кортеж длины $k$ из его элементов называют «$k$-кортеж из $n$». Общее число таких кортежей равно $n^k$.

Кортеж длины 2 называют **упорядоченная пара**. Кортеж из чисел – **вектор**.

#### Размещения

$A_n^k$ – **размещение из $n$ по $k$** (*arrangement*) – это *упорядоченный* набор из $k$ различных элементов, взятых из некоторого множества с мощностью $n$, где $k \leq n$, то есть некая перестановка $k$ выбранных элементов из $n$. $$A_n^k = n^{\underline k}=\frac {n!}{(n−k)!} = n⋅(n−1)⋅(n−2)⋅ … ⋅(n−k+1)$$
## Биноминальные коэффициенты и сочетания

### Сочетания

$C_n^k$ – **сочетание из $n$ по $k$** (*combinations*) – это *неупорядоченный* набор из $k$ различных элементов, взятых из некоторого множества мощностью $n$, где $k \leq n$, то есть набор для которого порядок выбора не имеет значения.
$$C_n^k = \frac{A_n^k}{k!} = \frac{n!}{(n-k)!⋅k!}$$

$$C_n^0 = \frac{n!}{(n-0)!⋅0!} = \frac{n!}{n!} = 1$$
$$C_n^1 = \frac{n!}{(n-1)!⋅1!} = \frac{n!}{(n-1)!} = n$$
$$C_n^2 = \frac{n!}{(n-2)!⋅2!} = \frac{n⋅(n-1)}{2}$$

$C_n^k = C_n^{n-k}$ – свойство симметрии

### Биноминальные коэффициенты

**Бином** – многочлен из двух слагаемых.

![](/pics/pascals-triangle.jpg)

**Биномиальный коэффициент** показывает количество способов добраться в данную точку из вершины треугольника Паскаля.

Биномиальный коэффициент, стоящий на $n$-ой строке под номером $k$, равен количеству сочетаний из $n$ по $k$. Обе нумерации идут с нуля.
$$C_n^k = \frac{A_n^k}{k!} = \frac{n^{\underline k}}{k!} = \frac{n!}{(n-k)! \cdot k!}$$

По краям в треугольника Паскаля стоят единицы, а любое значение в середине равно двух чисел над ними:
$$C_n^k = C_{n-1}^{k-1} + C_{n-1}^{k}$$

### Бином Ньютона

#### Запись длинных сумм

$\sum_{i=m}^{n} a_i = a_m + a_{m+1} + a_{m+2} + ... + a_{n-1} + a_n$ ,
где $i$ – индекс суммирования, $a_i$ – переменная означающая каждый член в серии, $m$ – нижняя граница суммирования, $n$ – верхняя граница суммирования, $i=m$ – стартовое значение индекса $i$ эквивалентно $m$.
В программировании данной процедуре соответствует **цикл `for`**.

Чтобы найти **количество слагаемых** в сумме, нужно из верхнего предела суммирования вычесть число, *предшествующее* нижнему пределу.

#### Бином Ньютона

$(a+b)^n = \sum_{k=0}^n C_n^k a^{n-k} b^{k}$ – **бином Ньютона** это общая формула возведения двучлена $(a+b)$ в степень.
В данной сумме $n$ соответствует номеру ряда треугольника Паскаля, а $k$ – номер коэффициента в $n$-ом ряду, количество слагаемых равно $(n+1)$.

$(a+b)^n = \sum_{k=0}^n C_n^k a^{n-k} b^{k} = \sum_{k=0}^n C_n^k a^{k} b^{n-k}$ – по свойству симметрии биноминальных коэффициентов.

$\sum_{k=0}^n C_n^k = 2^n$ – сумма биноминальных коэффициентов в строке $n$ равна $2^n$
$\sum_{k=0}^n C_n^k(-1)^k = 0$ – знакопеременная сумма биноминальных коэффициентов в строке $n$ равна нулю.

## Текстовые задачи

Если порядок важен – *размещения* (arrangements).
(rank, prizes, positions, distinct, unique, different)

Если порядок не важен – *сочетания* (combinations).
(same, teams, groups, identical, similar, same size & shape)

Если под условие попадает несколько вариантов, которые можно по смыслу заменить союзом «или» – *правило суммы*.
Если нужно подсчитать варианты «комплектов» событий – *правило произведения*.

![](/pics/sets-of-elements.png)